
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="static/favicon.ico">

    <title>Players'Grand Banquet</title>

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<style>
		@-ms-viewport     { width: device-width; }
		@-o-viewport      { width: device-width; }
		@viewport         { width: device-width; }
		html,
body {
  overflow-x: hidden; /* Prevent scroll on narrow devices */
}
body {
  padding-top: 70px;
}
footer {
  padding: 30px 0;
}

/*
 * Off Canvas
 * --------------------------------------------------
 */
@media screen and (max-width: 767px) {
  .row-offcanvas {
    position: relative;
    -webkit-transition: all .25s ease-out;
         -o-transition: all .25s ease-out;
            transition: all .25s ease-out;
  }

  .row-offcanvas-right {
    right: 0;
  }

  .row-offcanvas-left {
    left: 0;
  }

  .row-offcanvas-right
  .sidebar-offcanvas {
    right: -50%; /* 6 columns */
  }

  .row-offcanvas-left
  .sidebar-offcanvas {
    left: -50%; /* 6 columns */
  }

  .row-offcanvas-right.active {
    right: 50%; /* 6 columns */
  }

  .row-offcanvas-left.active {
    left: 50%; /* 6 columns */
  }

  .sidebar-offcanvas {
    position: absolute;
    top: 0;
    width: 50%; /* 6 columns */
  }
}
	</style>
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Players'Grand Banquet</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a id="my" href="#">My statistics</a></li>
            <li><a id="finish" href="#">Income statistics</a></li>
			<li><a id="pool24" href="#">Prize pool data</a></li>
            <li><a id="usall" href="#">User list</a></li>
          </ul>
          
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h2 class="page-header">Income statistics</h2>
          
          <div class="table-responsive finishtable">
			<div></div>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>date</th>
                  <th>Investment total number</th>
				  <th>Total investment ETH</th>
                  <th>Weight income</th>
                  <th>Angle income</th>
                  
                </tr>
              </thead>
              <tbody id="finish_content">
                
              </tbody>
            </table>
          </div>
		  
		  <div class="table-responsive finishdetailtable hidden">
			<div></div>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>#id</th>
                  <th>finish date</th>
				  <th>targer</th>
				  
                  
                  <th>finish team</th>
				  <th>finish angle</th>
                  
                </tr>
              </thead>
              <tbody id="finish_detail_content">
                
              </tbody>
            </table>
          </div>
		  
		   <div class="table-responsive usalltable hidden">
			<div></div>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>#id</th>
                  <th>address</th>
				  <th>VIP</th>
				  
                  <th>business</th>
                  
                </tr>
              </thead>
              <tbody id="usall_content">
                
              </tbody>
            </table>
          </div>
		  
		  <div class="table-responsive pool24table hidden">
			<div></div>
            <table class="table table-striped">
              <thead>
                <tr>
                  
                  <th>Round</th>
				  <th>Pool</th>
				  
                  <th>Begin Timestamp</th>
                  <th>End Timestamp</th>
                </tr>
              </thead>
              <tbody id="pool24_content">
                
              </tbody>
            </table>
          </div>
		  
		  <div class="table-responsive pool24detailtable hidden">
			<div></div>
            <table class="table table-striped">
              <thead>
                <tr>
                  
                  <th>Round</th>
				  <th>Win Level</th>
				  
                  <th>Winer</th>
                  <th>Win ETH</th>
                </tr>
              </thead>
              <tbody id="pool24_detail_content">
                
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
	
	<script src="static/web3.min.js" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>
	<script src="static/bignumber.min.js"></script>
	<script src="static/alertify.js"></script>
	<script src="static/store.min.js"></script>
	<script src="static/clipboard.min.js"></script>
	
	<script>
		$(document).ready(function () {
			  var uurl = "http://127.0.0.1:8886/admin";
              $("#finish").click(function () {
                 $.ajax({
                     url: uurl + "/us/finish",
                     type: "GET",
					 contentType: 'application/json',
                     success: function (data) {
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!");}
						 $(".pool24table").addClass("hidden");
						 $(".pool24detailtable").addClass("hidden");
						 $(".finishdetailtable").addClass("hidden");
						 $(".usalltable").addClass("hidden");
						 $(".finishtable").removeClass("hidden");
						 
						 var res = data.data;
						 $("#finish_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td><a href='javascript:;' cid='"+res[i].id+"' id='cdateBtn'>" + res[i].cdate+ "</a></td><td>" +res[i].inputAmt + " ETH</td><td>" + res[i].inputCount + "</td><td>" + res[i].finishTeam + " ETH</td><td>" + res[i].finishAngle + " ETH</td></tr>");
							//console.log(tr.html());
							$("#finish_content").append(tr);
							});
						 
                     }
                 });
 
             });
			 
			 $("#pool24").click(function () {
                 $.ajax({
                     url: uurl + "/us/pool24",
                     type: "GET",
					 contentType: 'application/json',
                     success: function (data) {
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!");}
						 $(".pool24table").removeClass("hidden");
						 $(".pool24detailtable").addClass("hidden");
						 $(".finishdetailtable").addClass("hidden");
						 $(".usalltable").addClass("hidden");
						 $(".finishtable").addClass("hidden");
						 
						 var res = data.data;
						 $("#pool24_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td><a href='javascript:;' cid='"+res[i].round+"' id='roundBtn'>Round " + res[i].round+ "</a></td><td>" +res[i].pot + " ETH</td><td>" + res[i].bts + "</td><td>" + res[i].ets + "</td></tr>");
							//console.log(tr.html());
							$("#pool24_content").append(tr);
							});
						 
                     }
                 });
 
             });
			 
			 $("#pool24_content").on('click',"a[id='roundBtn']",function() { 
				var cid = $(this).attr("cid");
				
				$.ajax({
                     url: uurl + "/us/pool24detail",
                     type: "GET",
					 data: { round: cid },
					 contentType: 'application/json',
                     success: function (data) {
                         
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!!");}
						 $(".pool24table").addClass("hidden");
						 $(".pool24detailtable").removeClass("hidden");
						 $(".finishtable").addClass("hidden");
						 $(".usalltable").addClass("hidden");
						 $(".finishdetailtable").addClass("hidden");
						 var res = data.data;
						 $("#pool24_detail_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td>Round " + res[i].round + "</td><td>Level " + res[i].winlevel+ "</td><td>" + res[i].winer + "</td><td>" + res[i].win + " ETH&nbsp;&nbsp;<a href='javascript:;' addr='"+res[i].winer+"' eth='"+res[i].win+"' id='transferBtn4pool24'>Transfer</a></td></tr>");
							
							$("#pool24_detail_content").append(tr);
							});
						 
                     }
                 });
			});
			 
			
			
			 $("#finish_content").on('click',"a[id='cdateBtn']",function() { 
				var cid = $(this).attr("cid");
				
				$.ajax({
                     url: uurl + "/us/finishdetail",
                     type: "GET",
					 data: { id: cid },
					 contentType: 'application/json',
                     success: function (data) {
						
                         //var result = JSON.stringify(data);
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!!");}
						 $(".pool24table").addClass("hidden");
						 $(".pool24detailtable").addClass("hidden");
						 $(".finishtable").addClass("hidden");
						 $(".usalltable").addClass("hidden");
						 $(".finishdetailtable").removeClass("hidden");
						 var res = data.data;
						 $("#finish_detail_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td>" + res[i].id + "</td><td>" + res[i].cdate+ "</td><td>" + res[i].finishTarger + "</td><td>" + res[i].finishTeamAmt + " ETH&nbsp;&nbsp;<a href='javascript:;' addr='"+res[i].finishTarger+"' id='transferBtn4Team'>Transfer</a></td><td>" + res[i].finishAngleAmt + " ETH&nbsp;&nbsp;<a href='javascript:;' addr='"+res[i].finishTarger+"' id='transferBtn4Angle'>Transfer</a></td></tr>");
							//console.log(tr.html());
							$("#finish_detail_content").append(tr);
							});
						 
                     }
                 });
			});
			
			/*$("#my").click(function () {
                 $.ajax({
                     url: uurl + "/us/info/" + defaultAccount,
                     type: "GET",
					 contentType: 'application/json',
                     success: function (data) {
                         //var result = JSON.stringify(data);
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!!");}
						 $(".finishdetailtable").addClass("hidden");
						 $(".finishtable").removeClass("hidden")
						 
						 var res = data.data;
						 $("#finish_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td><a href='javascript:;' cid='"+res[i].id+"' id='cdateBtn'>" + res[i].my+ "</a></td><td>" +res[i].vip + " 级</td><td>" + res[i].bus + " ETH</td></tr>");
							//console.log(tr.html());
							$("#finish_content").append(tr);
							});
						 
                     }
                 });
 
             });*/
			 
			 $("#usall").click(function () {
                 $.ajax({
                     url: uurl + "/us/info/all",
                     type: "GET",
					 contentType: 'application/json',
                     
                     success: function (data) {
                         console.log(data);
						 if(data.code != 200){return alert("get data fail!!");}
						 $(".pool24table").addClass("hidden");
						 $(".pool24detailtable").addClass("hidden");
						 $(".finishtable").addClass("hidden");
						 $(".finishdetailtable").addClass("hidden");
						 $(".usalltable").removeClass("hidden");
						 
						 var res = data.data;
						 $("#usall_content").html("");
						 $.each(res, function (i, item) {
							
							var tr = $("<tr><td>" +res[i].id + "</td><td><a href='javascript:;'>" + res[i].my+ "</a></td><td>" +res[i].vip + " 级</td><td>" + res[i].bus + " ETH</td></tr>");
							//console.log(tr.html());
							$("#usall_content").append(tr);
							});
						 
                     }
                 });
 
             });
			 
			 $("#pool24_detail_content").on('click',"a[id='transferBtn4pool24']",function() { 
				if(!checkAll()){return;}
				var eth = $(this).attr("eth");
				var addr = $(this).attr("addr");
				var ethwei = web3.utils.toWei(eth+"", 'ether');
				if(defaultAccount != null)
					iconins.methods.outPool242Win(addr, ethwei).send({from: defaultAccount, value: 0, gas:600000}, function(err, result){
						if(err){
							alertify.error(err.message);
						}	
					});
			});
			
			$("#finish_detail_content").on('click',"a[id='transferBtn4Team']",function() { 
				if(!checkAll()){return;}
				var eth = $(this).attr("eth");
				var addr = $(this).attr("addr");
				var ethwei = web3.utils.toWei(eth+"", 'ether');
				if(defaultAccount != null)
					iconins.methods.outTeamgen(addr, ethwei).send({from: defaultAccount, value: ethwei, gas:600000}, function(err, result){
						if(err){
							alertify.error(err.message);
						}	
					});
				
			});
			
			$("#finish_detail_content").on('click',"a[id='transferBtn4Angle']",function() { 
				if(!checkAll()){return;}
				var eth = $(this).attr("eth");
				var addr = $(this).attr("addr");
				var ethwei = web3.utils.toWei(eth+"", 'ether');
				if(defaultAccount != null)
					iconins.methods.outAnglegen(addr, ethwei).send({from: defaultAccount, value: ethwei, gas:600000}, function(err, result){
						if(err){
							alertify.error(err.message);
						}	
					});
				
			});
			
var abi = [{"anonymous":false,"inputs":[{"indexed":true,"name":"previousOwner","type":"address"},{"indexed":true,"name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"constant":false,"inputs":[],"name":"activate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"value","type":"uint256"},{"indexed":false,"name":"data","type":"bytes"}],"name":"onReceiveApproval","type":"event"},{"constant":false,"inputs":[{"name":"_addr","type":"address"},{"name":"_rateW","type":"uint256"}],"name":"addOrSetNode","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_recommander","type":"address"}],"name":"buy","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"buyT","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"deposit","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"finishStc","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_a0","type":"address"},{"name":"_val","type":"uint256"}],"name":"infoSos","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_a0","type":"address"}],"name":"infoSosAll","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"},{"name":"_anglegen","type":"uint256"}],"name":"outAnglegen","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"},{"name":"_win","type":"uint256"}],"name":"outBPool2Win","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"},{"name":"_win","type":"uint256"}],"name":"outPool242Win","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"},{"name":"_teamgen","type":"uint256"}],"name":"outTeamgen","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"pool24Open","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_recommander","type":"address"}],"name":"pubreg","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_sender","type":"address"},{"name":"_value","type":"uint256"},{"name":"_extraData","type":"bytes"}],"name":"receiveApproval","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_recommander","type":"address"},{"name":"_eth","type":"uint256"}],"name":"reLoad","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_oneB","type":"uint256"},{"name":"_twoB","type":"uint256"},{"name":"_threeB","type":"uint256"}],"name":"set3FloorRate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_min","type":"uint256"}],"name":"setBpool4Min","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_min","type":"uint256"}],"name":"setBpoolBlock4Min","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_token","type":"address"}],"name":"setBurnToken","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_times","type":"uint256"}],"name":"setBurnTokenTimes","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_addr","type":"address"}],"name":"setCoutier","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_fixRetWs","type":"uint256[]"}],"name":"setFixRet1","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_fixRetWs","type":"uint256[]"}],"name":"setFixRet2","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_eths1","type":"uint256"},{"name":"_o1S","type":"uint256"},{"name":"_eths2","type":"uint256"},{"name":"_o2S","type":"uint256"},{"name":"_eths3","type":"uint256"},{"name":"_o3S","type":"uint256"}],"name":"setFixRet4Eth","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_fixRetWs","type":"uint256[]"}],"name":"setFixRetBet","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_gdyB","type":"uint256"},{"name":"_gstaticB","type":"uint256"},{"name":"_gbpoolB","type":"uint256"},{"name":"_gnodeB","type":"uint256"}],"name":"setGper","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_min","type":"uint256"}],"name":"setMin","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_spoolOpenTime","type":"uint256"}],"name":"setSpoolOpenTime4Min","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_perior","type":"uint256"}],"name":"setStcPerior4Min","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"startNextRound4Bpool","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"take","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"take4Angle","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"take4Parter","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"take4Team","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"address0_","type":"address"},{"name":"address1_","type":"address"}],"name":"updateRecommander","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"_recommandCountM","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"_recommandLinkM","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"_regM","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"activated_","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"burnToken_","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"burnTokenTimes_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"coutier_","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimal_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"fixRet_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"fixRetOutTimes_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"fixRetW1_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"fixRetW2_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"fixRetWBet_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentRoundInfo","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getCurrentRoundInfo424","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getExtData","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getFixRet","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getGper","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getHisRoundInfo","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getLeftTime24","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getNodeData","outputs":[{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getPlayerExtByAddress","outputs":[{"name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getPlayerInfoByAddress","outputs":[{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getRecomCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getRecomCountByAddress","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"address_","type":"address"}],"name":"getRecommander","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getRecommander","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getRecommanderByAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_pAddress","type":"address"},{"name":"_recommander","type":"address"}],"name":"getRegLimit","outputs":[{"name":"","type":"bool"},{"name":"","type":"bool"},{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getTimeLeft","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_addr","type":"address"}],"name":"getWinRecord","outputs":[{"name":"","type":"uint256[]"},{"name":"","type":"uint256[]"},{"name":"","type":"uint256[]"},{"name":"","type":"uint256[]"},{"name":"","type":"uint256[]"},{"name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"gMin_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"address_","type":"address"}],"name":"isCanReg","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"address_","type":"address"}],"name":"isExitsRecommander","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_pAddress","type":"address"},{"name":"_now","type":"uint256"}],"name":"isOverFixResCount","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"node_","outputs":[{"name":"addr","type":"address"},{"name":"rateW","type":"uint256"},{"name":"gen","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"nodeinc_","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"plyr_","outputs":[{"name":"addr","type":"address"},{"name":"win","type":"uint256"},{"name":"gen","type":"uint256"},{"name":"dy","type":"uint256"},{"name":"t","type":"uint256"},{"name":"curjoin","type":"uint256"},{"name":"tdy","type":"uint256"},{"name":"meth","type":"uint256"},{"name":"lastFixResTime","type":"uint256"},{"name":"fixResCount","type":"uint256"},{"name":"incomeLimit","type":"uint256"},{"name":"teamgen","type":"uint256"},{"name":"anglegen","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"},{"name":"","type":"uint256"}],"name":"plyrRnds_","outputs":[{"name":"eth","type":"uint256"},{"name":"win","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"},{"name":"","type":"uint256"}],"name":"plyrRnds24_","outputs":[{"name":"win","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"pool24_","outputs":[{"name":"strt","type":"uint256"},{"name":"end","type":"uint256"},{"name":"pot","type":"uint256"},{"name":"ended","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"r24ID_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"recomB_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"address_","type":"address"}],"name":"recommandCount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"rID_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"rndGap_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"rndInc_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"rndInit_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"round_","outputs":[{"name":"end","type":"uint256"},{"name":"strt","type":"uint256"},{"name":"eth","type":"uint256"},{"name":"pot","type":"uint256"},{"name":"inva1","type":"address"},{"name":"ended","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"spoolOpenTime_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"stcPerior_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"tdestroy_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}];

var gcontract="0xc2d3413f9a799138c4fd5e6ce69e51b0c7512018";
var BN = BigNumber.clone();
//var itickets;
var gnetId = 3;

var netCheck = false;
var symbol;
var web3 = window.web3;
var myTickets;
var times;
var parterCanWd = 0;
var defaultAccount = "";
var isStart = false;

var tipl = 
	["This is a test, please use the ropsten test network!", "Please use the official Ethereum main network!", "For Chrome, Firefox please download <a style='color:#fcd21c;font-size:18px;' href=' Https://metamask.io/'>metamask</a> or mobile phone download <a style='color:#fcd21c;font-size:18px;' href='https://trustwalletapp.com/'>trustwallet</a> !", "Please login to Metamask or trustwallet!", "Please select the correct Ethernet network!", "Successful copy:", "Please enter the correct referrer", "The minimum investment amount is 1!", "Your total deposit must be greater than 1 before re-investment!", "The amount of your re-investment must be less than your total deposit amount!",
	"Your total deposit must be greater than 0.01 before it can be withdrawn!", "Your ticket is not enough ", "Invalid referrer, please confirm that the referrer has participated","There are already recommenders","Invalid referrer, please confirm that the referee is involved in the wealth journey","You have been tied as a referrer and cannot register", "Your investment in the investment still has a profit, please wait for the income to be completed and then invest again!", "Data loading, please wait...", "Minimum purchase", "Please confirm that your input is correct"];
	
var checkNet = function(){
	if(isStart)return;
	console.log("init web3...");
	if (window.ethereum) {
	web3 = window.web3 = new Web3(ethereum);
	try {
	  //await ethereum.enable();
	  isStart = true;
	  handlerWeb3(window.web3);
	  
	}catch (error) {
	}
  }
  else if (window.web3) {
	web3 = window.web3 = new Web3(web3.currentProvider);
	isStart = true;
	handlerWeb3(window.web3);
  }
  else {
	alertify.error(tipl[2]);
  }
};
	
var handlerWeb3 = function(web3){
	iconins = new web3.eth.Contract(abi, gcontract);
	//itickets = new web3.eth.Contract(abitoken, ticket);
	web3.eth.net.getId(function(err, netId){
		//console.log(netId);
		if(netId != gnetId){
			if(gnetId == 3 || gnetId == 4)
				alertify.error(tipl[0]);
			if(gnetId == 1)
				alertify.error(tipl[1]);
		}else{
			netCheck = true;
			checkLogin();
		}
	});
};

var checkLogin = function(){
var accountInterval = setInterval(function() {
	web3.eth.getAccounts(function(err, acc){
		if(err != null){
			console.log('error');
			return;
		}
		if(acc.length==0 && defaultAccount !=""){
			window.location.reload();
			return;
		}
		
		if(acc.length==0){
			//console.log('please login metamask or trustwallet.');
			return;
		}
		if (acc[0] != defaultAccount) {
			defaultAccount = acc[0];
			//
			window.location.reload();
			console.log("account change, start bat updateData!");
		  }
	});
}, 1000);
	
web3.eth.getAccounts(function(err,accounts){
	if(err){
		alertify.error(err);
		return;
	}
	if(accounts.length==0){
	  
	  alertify.error(tipl[3]);
	  return;
	}
	
	defaultAccount = accounts[0];
	
});
};

var checkAll = function(){
	if(!web3){
		noWeb3();
		return false;
	}
	if(!netCheck){
		errNet();
		return false;
	}
	if(!defaultAccount || defaultAccount == ""){
		alertify.error(tipl[3]);
		return;
	}
	return true;
};

var noWeb3 = function(){
	 alertify.error(tipl[2]);
};

var errNet = function(){
	alertify.error(tipl[4]);
};

var init = function(){
	checkNet();
	setInterval(function() {
		console.log("check net...");
		checkNet();
		
	}, 3000);
};

init();
});
	</script>
  </body>
</html>
